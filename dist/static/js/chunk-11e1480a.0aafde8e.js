(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-11e1480a"],{"074d":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"view-header"},[n("div",{staticClass:"icon-back",on:{click:e.back}}),n("span",{staticClass:"header-title"},[e._v(e._s(e.title))]),e.subtitle?n("span",{staticClass:"header-info"},[e._v(e._s(e.subtitle))]):e._e()])},r=[],a={name:"viewHeader",props:{title:{type:String,required:!0},subtitle:String},methods:{back:function(){this.$router.back()}}},s=a,o=(n("0f6c"),n("2877")),l=Object(o["a"])(s,i,r,!1,null,"2a55274f",null);l.options.__file="viewHeader.vue";t["a"]=l.exports},"0f6c":function(e,t,n){"use strict";var i=n("d83e"),r=n.n(i);r.a},"331c":function(e,t,n){},"456d":function(e,t,n){var i=n("4bf8"),r=n("0d58");n("5eda")("keys",function(){return function(e){return r(i(e))}})},"5eda":function(e,t,n){var i=n("5ca1"),r=n("8378"),a=n("79e5");e.exports=function(e,t){var n=(r.Object||{})[e]||Object[e],s={};s[e]=t(n),i(i.S+i.F*a(function(){n(1)}),"Object",s)}},"719a":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.order.order_status?n("div",{staticClass:"order"},[n("view-header",{attrs:{title:e.handles[e.order.order_status].title||"",subtitle:"商城实物商品交易订单查询及管理"}}),n("section",{staticClass:"section order-handles"},[n("div",{staticClass:"order-handles-left"},[n("div",{staticClass:"section-title"},[n("span",[e._v("当前订单状态：")]),n("span",[e._v(e._s(e.order.order_status))]),"待付款"===e.order.order_status?n("p",[n("span",[e._v("剩余")]),n("em",[e._v(e._s(e.handles[e.order.order_status].coutDown.hours))]),n("span",[e._v("小时")]),n("em",[e._v(e._s(e.handles[e.order.order_status].coutDown.minutes))]),n("span",[e._v("分")]),n("em",[e._v(e._s(e.handles[e.order.order_status].coutDown.seconds))]),n("span",[e._v("秒")])]):e._e()]),n("div",{staticClass:"order-handles-tip"},[e._v(e._s(e.handles[e.order.order_status].tip))])]),n("div",{staticClass:"order-handles-right"},e._l(e.handles[e.order.order_status].buttons,function(t){return n("el-button",{attrs:{size:"small",type:t.type},on:{click:t.handle}},[e._v(e._s(t.label))])}))]),n("section",{staticClass:"section"},[n("p",{staticClass:"section-title"},[e._v("基本信息")]),n("div",{staticClass:"col-container"},[n("div",{staticClass:"col"},[n("div",{staticClass:"col-row"},[n("span",{staticClass:"col-row-title"},[e._v("订单ID:")]),n("span",{staticClass:"col-row-value"},[e._v(e._s(e.order.order_id))])]),n("div",{staticClass:"col-row"},[n("span",{staticClass:"col-row-title"},[e._v("E-Mail:")]),n("span",{staticClass:"col-row-value"},[e._v(e._s(e.order.email))])]),n("div",{staticClass:"col-row"},[n("span",{staticClass:"col-row-title"},[e._v("订单状态:")]),n("span",{staticClass:"col-row-value"},[e._v(e._s(e.order.order_status))])])]),n("div",{staticClass:"col"},[n("div",{staticClass:"col-row"},[n("span",{staticClass:"col-row-title"},[e._v("订单号:")]),n("span",{staticClass:"col-row-value"},[e._v(e._s(e.order.order_sn))])]),n("div",{staticClass:"col-row"},[n("span",{staticClass:"col-row-title"},[e._v("下单时间:")]),n("span",{staticClass:"col-row-value"},[e._v(e._s(e.order.add_time))])]),n("div",{staticClass:"col-row"},[n("span",{staticClass:"col-row-title"},[e._v("支付方式:")]),n("span",{staticClass:"col-row-value"},[e._v(e._s(e.order.pay_name))])])]),n("div",{staticClass:"col"},[n("div",{staticClass:"col-row"}),n("div",{staticClass:"col-row"},[n("span",{staticClass:"col-row-title"},[e._v("应付金额:")]),n("span",{staticClass:"col-row-value"},[e._v(e._s(e.order.total_amount))])]),n("div",{staticClass:"col-row"},[n("span",{staticClass:"col-row-title"},[e._v("支付时间:")]),n("span",{staticClass:"col-row-value"},[e._v(e._s(e.order.pay_time))])])])])]),n("div",{staticClass:"section"},[n("div",{staticClass:"section-title"},[e._v("物流信息")]),n("div",{staticClass:"col-container"},[n("div",{staticClass:"col"},[e._m(0),n("div",{staticClass:"col-row"},[n("span",{staticClass:"col-row-title"},[e._v("收货人:")]),n("span",{staticClass:"col-row-value"},[e._v(e._s(e.order.consignee))])]),n("div",{staticClass:"col-row"},[n("span",{staticClass:"col-row-title"},[e._v("收货地址:")]),n("span",{staticClass:"col-row-value"},[e._v(e._s(""+e.order.province+e.order.city+e.order.district+e.order.address))])])]),n("div",{staticClass:"col"},[e._m(1),n("div",{staticClass:"col-row"},[n("span",{staticClass:"col-row-title"},[e._v("联系方式:")]),n("span",{staticClass:"col-row-value"},[e._v(e._s(e.order.mobile))])]),n("div",{staticClass:"col-row"},[n("span",{staticClass:"col-row-title"},[e._v("留言:")]),n("span",{staticClass:"col-row-value"},[e._v(e._s(e.order.user_note))])])])]),n("div",{staticClass:"border"}),n("div",{staticClass:"col-container"},[n("div",{staticClass:"col"},[e._m(2),n("div",{staticClass:"col-row"},[n("span",{staticClass:"col-row-title"},[e._v("物流公司名称:")]),n("span",{staticClass:"col-row-value"},[e._v(e._s(e.order.shipping_name))])]),n("div",{staticClass:"col-row"},[n("span",{staticClass:"col-row-title"},[e._v("物流公司电话:")]),n("span",{staticClass:"col-row-value"},[e._v(e._s(e.order.shipping_mobile))])]),n("div",{staticClass:"col-row"},[n("span",{staticClass:"col-row-title"},[e._v("物流公司地址:")]),n("span",{staticClass:"col-row-value"},[e._v(e._s(e.order.shipping_address))])]),n("div",{staticClass:"col-row"},[n("span",{staticClass:"col-row-title"},[e._v("所在地区:")]),n("span",{staticClass:"col-row-value"},[e._v(e._s(""+e.order.shipping_province+e.order.shipping_city+e.order.shipping_district))])]),n("div",{staticClass:"col-row"},[n("span",{staticClass:"col-row-title"},[e._v("物流备注:")]),n("span",{staticClass:"col-row-value"},[e._v(e._s(e.order.shipping_note))])])]),n("div",{staticClass:"col"},[e._m(3),n("div",{staticClass:"col-row"},[n("span",{staticClass:"col-row-title"},[e.$route.query.editLog?n("i",[e._v("*")]):e._e(),n("span",[e._v("物流公司名称:")])]),e.$route.query.editLog?n("el-input",{staticClass:"col-row-input",attrs:{size:"small"},model:{value:e.form.shipping_name,callback:function(t){e.$set(e.form,"shipping_name",t)},expression:"form.shipping_name"}}):n("span",{staticClass:"col-row-value"},[e._v(e._s(e.order.real_shipping_name))])],1),n("div",{staticClass:"col-row"},[n("span",{staticClass:"col-row-title"},[e.$route.query.editLog?n("i",[e._v("*")]):e._e(),n("span",[e._v("物流公司电话:")])]),e.$route.query.editLog?n("el-input",{staticClass:"col-row-input",attrs:{size:"small"},model:{value:e.form.shipping_mobile,callback:function(t){e.$set(e.form,"shipping_mobile",t)},expression:"form.shipping_mobile"}}):n("span",{staticClass:"col-row-value"},[e._v(e._s(e.order.real_shipping_mobile))])],1),n("div",{staticClass:"col-row"},[n("span",{staticClass:"col-row-title"},[e.$route.query.editLog?n("i",[e._v("*")]):e._e(),n("span",[e._v("物流单号:")])]),e.$route.query.editLog?n("el-input",{staticClass:"col-row-input",attrs:{size:"small"},model:{value:e.form.invoice_no,callback:function(t){e.$set(e.form,"invoice_no",t)},expression:"form.invoice_no"}}):n("span",{staticClass:"col-row-value"},[e._v(e._s(e.order.invoice_no))])],1),n("div",{staticClass:"col-row"},[n("span",{staticClass:"col-row-title"},[e.$route.query.editLog?n("i",[e._v("*")]):e._e(),n("span",[e._v("发货件数:")])]),e.$route.query.editLog?n("el-input",{staticClass:"col-row-input",attrs:{size:"small"},model:{value:e.form.send_num,callback:function(t){e.$set(e.form,"send_num",t)},expression:"form.send_num"}}):n("span",{staticClass:"col-row-value"},[e._v(e._s(e.order.send_num))])],1),n("div",{staticClass:"col-row"},[n("span",{staticClass:"col-row-title"},[e.$route.query.editLog?n("i",[e._v("*")]):e._e(),n("span",[e._v("预计到货时间:")])]),e.$route.query.editLog?n("el-input",{staticClass:"col-row-input",attrs:{size:"small"},model:{value:e.form.arrival_time,callback:function(t){e.$set(e.form,"arrival_time",t)},expression:"form.arrival_time"}}):n("span",{staticClass:"col-row-value"},[e._v(e._s(e.order.arrival_time))])],1)]),n("div",{staticClass:"upload"},["待发货"===e.order.order_status?n("div",{ref:"upBtn",staticClass:"upload-empty",style:{visibility:!e.form.invoice_img&&e.$route.query.editLog?"initial":"hidden"}},[e._v("点击上传")]):e._e(),n("img",{staticClass:"upload-file",attrs:{src:e.form.invoice_img}}),!e.$route.query.editLog&&e.form.invoice_img?n("div",{staticClass:"upload-tip"},[n("i",[e._v("*")]),n("span",[e._v("物流单照片(点击放大)")])]):e._e()])])]),n("div",{staticClass:"section"},[n("p",{staticClass:"section-title"},[e._v("商品信息")]),n("el-table",{staticClass:"order-goods",attrs:{"cell-style":{fontSize:"12px",paddingTop:"20px",paddingBottom:"20px"},border:"",data:e.order.goods}},[n("el-table-column",{attrs:{"min-width":"369",label:"商品",align:"center",prop:"goods_name"}}),n("el-table-column",{attrs:{"min-width":"140",label:"规格属性",align:"center",prop:"spec_key_name"}}),n("el-table-column",{attrs:{"min-width":"140",label:"数量",align:"center",prop:"goods_num"}}),n("el-table-column",{attrs:{"min-width":"140",label:"结算单价",align:"center",prop:"goods_price"}}),n("el-table-column",{attrs:{"min-width":"140",label:"总价",align:"center",prop:"price"}})],1),n("p",{staticClass:"total-price"},[n("span",[e._v("实收款:")]),n("span",[e._v(e._s(e.order.price))])])],1),n("div",{staticClass:"section"},[n("p",{staticClass:"section-title-small"},[e._v("操作记录")]),n("el-table",{staticClass:"order-logs",attrs:{"cell-style":{fontSize:"12px",paddingTop:"20px",paddingBottom:"20px"},border:"",data:e.order.actionLog}},[n("el-table-column",{attrs:{"min-width":"160",label:"操作者",align:"center",prop:"action_user"}}),n("el-table-column",{attrs:{"min-width":"160",label:"操作时间",align:"center",prop:"log_time"}}),n("el-table-column",{attrs:{"min-width":"160",label:"订单状态",align:"center",prop:"order_status"}}),n("el-table-column",{attrs:{"min-width":"160",label:"付款状态",align:"center",prop:"pay_status"}}),n("el-table-column",{attrs:{"min-width":"160",label:"发货状态",align:"center",prop:"shipping_status"}}),n("el-table-column",{attrs:{"min-width":"160",label:"描述",align:"center",prop:"status_desc"}})],1)],1)],1):e._e()},r=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"col-header"},[n("div",{staticClass:"col-header-title"},[e._v("收货信息")]),n("div",{staticClass:"col-header-empty"})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"col-header"},[n("div",{staticClass:"col-header-title"},[e._v("收货信息")]),n("div",{staticClass:"col-header-empty"})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"col-header"},[n("div",{staticClass:"col-header-title"},[e._v("区代要求物流")]),n("div",{staticClass:"col-header-empty"})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"col-header"},[n("div",{staticClass:"col-header-title"},[e._v("供货商实发物流")]),n("div",{staticClass:"col-header-empty"})])}],a=(n("a481"),n("be94")),s=(n("ac6a"),n("456d"),n("7f7f"),n("96cf"),n("1da1")),o=(n("cadf"),n("551c"),n("097d"),n("7bbc")),l=n.n(o),c=n("074d"),u=n("880a"),d={current:"",shipping_name:"物流公司必填",shipping_mobile:"物流公司电话必填",invoice_no:"物流单号必填",send_num:"发货件数必填",arrival_time:"预计到货时间必填",invoice_img:"请上传物流单照片"},f=null,p={name:"orderDetail",data:function(){return{order:{},form:{shipping_name:"",shipping_mobile:"",invoice_no:"",send_num:"",arrival_time:"",invoice_img:""},handles:{"待付款":{title:"等待买家付款",tip:"提示：供货商主动关闭订单之后将中断订单流程，并且将被平台征信记录，请谨慎操作“关闭订单”功能",coutDown:{hours:"00",minutes:"00",seconds:"00"},buttons:[{type:"primary",label:"打印订单",handle:this.print},{type:"danger",label:"关闭订单",handle:this.close}]},"待确定":{title:"待确定",tip:"提示：①订单确认之后不可再关闭；②供货商主动关闭订单之后将中断订单流程，并且将被平台征信记录，请谨慎操作",buttons:[{type:"primary",label:"确定订单",handle:this.confirm},{type:"primary",label:"打印订单",handle:this.print},{type:"danger",label:"关闭订单",handle:this.close}]},"待发货":{title:"待发货",buttons:[{type:"primary",label:"去发货",handle:this.send},{type:"primary",label:"打印订单",handle:this.print}]},"已发货":{title:"已发货",buttons:[{type:"primary",label:"打印订单",handle:this.print}]},"已成功":{title:"已成功",buttons:[{type:"primary",label:"打印订单",handle:this.print}]},"申请退款中":{tip:"提示：该订单为未发货订单，同意退款之后，货款自动按照原路退还区代，并关闭该订单",buttons:[{type:"danger",label:"同意退款",handle:this.agreeRefund},{type:"primary",label:"拒绝退款",handle:this.refuseRefund},{type:"primary",label:"打印订单",handle:this.print}]},"已取消":{tip:"提示：该订单为区代取消",buttons:[{type:"primary",label:"打印订单",handle:this.print}]},"已关闭":{tip:"提示：该订单为供应商关闭",buttons:[{type:"primary",label:"打印订单",handle:this.print}]},"已退款":{tip:"提示：该订单为供应商退款",buttons:[{type:"primary",label:"打印订单",handle:this.print}]}}}},methods:{getOrderDetail:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(){var t,n,i,r=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$axios.get(u["r"],{params:{order_id:this.$route.params.id}});case 3:t=e.sent,n=t.data.order,this.order=n,"待付款"===this.order.order_status&&(f=setInterval(function(){r.coutDown()},1e3)),e.next=13;break;case 9:e.prev=9,e.t0=e["catch"](0),i=e.t0.msg,this.$message.error(i);case 13:case"end":return e.stop()}},e,this,[[0,9]])}));return function(){return e.apply(this,arguments)}}(),coutDown:function(){var e=(new Date).getTime(),t=new Date(this.order.add_time).getTime()+864e5,n=t-e;if(n<=0)this.getOrderDetail(),clearInterval(f);else{var i=parseInt(n%864e5/36e5),r=parseInt(n%36e5/6e4),a=parseInt(n%6e4/1e3);this.handles["待付款"].coutDown.hours=i,this.handles["待付款"].coutDown.minutes=r,this.handles["待付款"].coutDown.seconds=a}},initUpload:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(){var t,n,i,r,a=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$axios.get(u["u"]);case 3:t=e.sent,n=t.data,l.a.config({url:n.url,ACCESS_KEY:"vmTCREvwoIH3u4if282WvCbJ8vCTVkW-kTuLuPr2",SECRET_KEY:"3-s3qBM1JjH6tPdTjfihP50WkGBkTx85V0CX-TyL"}),i=l.a.bucket("chao",{putToken:n.token}),l.a.bind(this.$refs.upBtn,{filter:"image"}).on("file",function(e){i.putFile(e.name,e,function(e,t){e?a.$message.error(e):a.form.invoice_img="".concat(n.url).concat(t.key)})}),e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](0),r=e.t0.msg,this.$message.error(r);case 14:case"end":return e.stop()}},e,this,[[0,10]])}));return function(){return e.apply(this,arguments)}}(),print:function(){this.$modal.show("printOrder",{order:this.order})},close:function(){this.$modal.show("closeOrder",{orderId:id})},confirm:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$axios.post(u["d"],{order_id:this.order.order_id});case 3:this.getOrderDetail(),this.$message({message:"操作成功",type:"success"}),e.next=11;break;case 7:e.prev=7,e.t0=e["catch"](0),t=e.t0.msg,this.$message.error(t);case 11:case"end":return e.stop()}},e,this,[[0,7]])}));return function(){return e.apply(this,arguments)}}(),send:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(){var t,n,i=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,1!=this.$route.query.editLog){e.next=14;break}if(t=Object.keys(this.form).every(function(e){return i.form[e]||(d["current"]=d[e]),i.form[e]}),!t){e.next=11;break}return e.next=6,this.$axios.post(u["w"],Object(a["a"])({},this.form,{order_id:this.order.order_id}));case 6:this.getOrderDetail(),this.$message({message:"操作成功",type:"success"}),this.$router.replace({name:"orderDetail"}),e.next=12;break;case 11:this.$message.error(d["current"]);case 12:e.next=16;break;case 14:this.$router.replace({name:"orderDetail",query:Object(a["a"])({},this.$route.query,{editLog:1})}),this.handles["待发货"]["buttons"][0].label="确认发货";case 16:e.next=22;break;case 18:e.prev=18,e.t0=e["catch"](0),n=e.t0.msg,this.$message.error(n);case 22:case"end":return e.stop()}},e,this,[[0,18]])}));return function(){return e.apply(this,arguments)}}(),agreeRefund:function(){this.$modal.show("agreeRefund",{orderId:this.order.order_id})},refuseRefund:function(){this.$modal.show("refuseRefund",{orderId:this.order.order_id})}},beforeRouteEnter:function(e,t,n){n(function(){var t=Object(s["a"])(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,n.getOrderDetail();case 2:1==e.query.editLog&&(n.handles["待发货"]["buttons"][0].label="确认发货",n.$nextTick(function(){n.initUpload()}));case 3:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}())},beforeRouteUpdate:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(t,n,i){var r=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return i(),e.next=3,this.getOrderDetail();case 3:1==t.query.editLog&&(this.handles["待发货"]["buttons"][0].label="确认发货",this.$nextTick(function(){r.initUpload()}));case 4:case"end":return e.stop()}},e,this)}));return function(t,n,i){return e.apply(this,arguments)}}(),components:{viewHeader:c["a"]}},h=p,m=(n("dfce"),n("2877")),v=Object(m["a"])(h,i,r,!1,null,"baa6aec0",null);v.options.__file="detail.vue";t["default"]=v.exports},"7bbc":function(module,exports,__webpack_require__){(function(e,t){module.exports=t()})(0,function(){"use strict";var babelHelpers={};babelHelpers.typeof="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},babelHelpers.classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},babelHelpers.createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),babelHelpers.inherits=function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},babelHelpers.possibleConstructorReturn=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t};var slice=[].slice,nativeForEach=[].forEach||!1,utils={slice:slice,noop:function(){return!1},inherits:function(e,t){e.super_=t,e.prototype=utils.objCreate(utils.objExtend(utils.objClone(t.prototype),{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))},isString:function(e){return"string"==typeof e},isObject:function(e){return e instanceof Object},isArray:function(e){return e instanceof Array},isFunction:function(e){return e instanceof Function},isUndefine:function(e){return void 0===e},objClone:function(e){return utils.isObject(e)?utils.isArray(e)?e.slice():utils.objExtend({},e):e},objExtend:function(e){for(var t=slice.call(arguments,1),n=0;n<t.length;n++)(function(n){var i=t[n];if(i)for(var r in i)i.hasOwnProperty(r)&&(e[r]=i[r])})(n);return e},objCreate:function(e){if(arguments.length>1)throw new Error("Object.create implementation only accepts the first parameter.");function t(){}return t.prototype=e,new t},objKeys:function(e){if(utils.isFunction(e.key))return e.keys();var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t},each:function(e,t,n){if(null!=e)if(nativeForEach&&e.forEach===nativeForEach)e.forEach(t,n);else if(e.length===+e.length){for(var i=0,r=e.length;i<r;i++)if(!1===t.call(n,e[i],i,e))return}else{var a=utils.objKeys(e);for(i=0,r=a.length;i<r;i++)if(!1===t.call(n,e[a[i]],a[i],e))return}},format:function(e){if(!utils.isString(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(arguments[n]);return t.join(" ")}var i=slice.call(arguments,1),r=(n=0,arguments.length),a=/%[sd%]/g,s=String(e).replace(a,function(e){if("%%"===e)return"%";if(n>=r)return e;switch(e){case"%s":return String(i[n++]);case"%d":return Number(i[n++]);default:return e}});return s},safeEncode:function(e){var t=btoa(e),n=t.replace(/\//g,"_").replace(/\+/g,"-");return n},css:function(e,t){var n,i;if(e&&e.style)for(n in t){i=t[n],"number"==typeof i&&(i+="px");try{e.style[n]=i}catch(r){}}}},imageViewTranslations={weight:"w",height:"h",quality:"q"},Fop=function(){function e(t){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];babelHelpers.classCallCheck(this,e),this.parent=t,this.config=n,this.query=""}return babelHelpers.createClass(e,[{key:"fop",value:function(e){return this.query+="|"+e,this}},{key:"imageInfo",value:function(){return this.query+="|imageInfo",this}},{key:"exif",value:function(){return this.query+="|exif",this}},{key:"imageView",value:function(e){var t=e.mode;delete e.mode;this.url();var n={};return utils.each(e,function(e,t){imageViewTranslations.hasOwnProperty(t)&&(t=imageViewTranslations[t]),n[t]=e}),this.query+=utils.format("|imageView/%d%s",t,genOptUrl(n)),this}},{key:"imageMogr",value:function(e){var t={};return utils.objExtend(t,e),this.query+=utils.format("|imageMogr/v2/auto-orient%s",genOptUrl(t)),this}},{key:"watermark",value:function(e){var t={},n=e.mode;return delete e.mode,utils.objExtend(t,e),t.image=utils.safeEncode(t.image),this.query+=utils.format("|watermark/%d%s",n,genOptUrl(t)),this}},{key:"qrcode",value:function(e){return e=e||{mode:0,level:"L"},this.query+=utils.format("|qrcode/%d/level/%s",this.url(),e.mode,e.level),this}},{key:"md2html",value:function(e){e=e||{mode:!1,css:!1};var t="|md2html";return e.css&&(t+=utils.format("/%s",e.mode)),e.css&&(t+=utils.format("/css/%s",utils.safeEncode(e.css))),this.query+=t,this}},{key:"url",value:function(){return utils.format("%s?%s",this.parent.url(),this.query.substr(1))}},{key:"image",value:function(){var e=new Image;return e.src=this.url(),e}}]),e}();function genOptUrl(e){var t="";return utils.each(e,function(e,n){t+=utils.format("/%s/%s",n,e)}),t}var configData={};function noop$1(){return!1}var Asset$1=function(){function e(t,n){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];babelHelpers.classCallCheck(this,e),this.key=t,this.parent=n,this.config=i}return babelHelpers.createClass(e,[{key:"url",value:function(){return this.parent.url()+"/"+this.key}},{key:"entryUrl",value:function(){return utils.safeEncode(utils.format("%s:%s",this.parent.name,this.key))}},{key:"qrcode",value:function(e,t){switch(!0){case utils.isFunction(e):t=e,e={mode:0,level:"L"};break;case utils.isObject(e)&&utils.isUndefined(t):t=noop$1;break;case utils.isUndefined(e):e={mode:0,level:"L"},t=noop$1;break}var n=utils.format("%s?qrcode/%d/level/%s",this.url(),e.mode,e.level),i=new Image;return i.src=i.url=n,i}},{key:"fop",value:function(e){return new Fop(this,e)}},{key:"alias",value:function(e){var t=this.url();return t+=utils.format("%s%s",this.config.separate,e),t}},{key:"md2html",value:function(e){utils.isFunction(e)?(callback=e,e={mode:!1,css:!1}):utils.isObject(e)?callback=callback||noop$1:(callback=callback||noop$1,e={mode:!1,css:!1});var t=this.url()+"?md2html";return e.mode&&(t+=utils.format("/%s",e.mode)),e.css&&(t+=utils.format("/css/%s",utils.safeEncode(e.css))),t}}]),e}();function _Asset(e){return configData=e,Asset$1}
/**!
    * FileAPI — a set of tools for working with files
    *
    * @author  RubaXa  <trash@rubaxa.org>
    * @build lib/canvas-to-blob lib/FileAPI.core lib/FileAPI.Image lib/FileAPI.Form lib/FileAPI.XHR lib/FileAPI.Flash
    */
/*! fileapi 2.0.2 - BSD | git://github.com/mailru/FileAPI.git
    * FileAPI — a set of  javascript tools for working with files. Multiupload, drag'n'drop and chunked file upload. Images: crop, resize and auto orientation by EXIF.
    */window.FileAPI={staticPath:"http://iwillwen.u.qiniudn.com/",withCredentials:!1},function(e,t){var n=1,i=function(){},r=e.document,a=r.doctype||{},s=e.navigator.userAgent,o=e.createObjectURL&&e||e.URL&&URL.revokeObjectURL&&URL||e.webkitURL&&webkitURL,l=e.Blob,c=e.File,u=e.FileReader,d=e.FormData,f=e.XMLHttpRequest,p=e.jQuery,h=!!(c&&u&&(e.Uint8Array||d||f.prototype.sendAsBinary))&&!(/safari\//i.test(s)&&!/chrome\//i.test(s)&&/windows/i.test(s)),m=h&&"withCredentials"in new f,v=h&&!!l&&!!(l.prototype.webkitSlice||l.prototype.mozSlice||l.prototype.slice),g=e.dataURLtoBlob,y=/img/i,b=/canvas/i,w=/img|canvas/i,_=/input/i,x=/^data:[^,]+,/,C=e.Math,k=function(t){return t=new e.Number(C.pow(1024,t)),t.from=function(e){return C.round(e*this)},t},E={},A=[],I="abort progress error load loadend",F="status statusText readyState response responseXML responseText responseBody".split(" "),T="currentTarget",L="preventDefault",j=function(e){return e&&"length"in e},R=function(e,t,n){if(e)if(j(e))for(var i=0,r=e.length;i<r;i++)i in e&&t.call(n,e[i],i,e);else for(var a in e)e.hasOwnProperty(a)&&t.call(n,e[a],a,e)},O=function(e){for(var t=arguments,n=1,i=function(t,n){e[n]=t};n<t.length;n++)R(t[n],i);return e},S=function(e,t,n){if(e){var i=H.uid(e);E[i]||(E[i]={}),R(t.split(/\s+/),function(t){p?p.event.add(e,t,n):(E[i][t]||(E[i][t]=[]),E[i][t].push(n),e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n)})}},q=function(e,t,n){if(e){var i=H.uid(e),r=E[i]||{};R(t.split(/\s+/),function(t){if(p)p.event.remove(e,t,n);else{var i=r[t]||[],a=i.length;while(a--)if(i[a]===n){i.splice(a,1);break}e.addEventListener?e.removeEventListener(t,n,!1):e.detachEvent?e.detachEvent("on"+t,n):e["on"+t]=null}})}},D=function(e,t,n){S(e,t,function i(r){q(e,t,i),n(r)})},U=function(t){return t.target||(t.target=e.event&&e.event.srcElement||r),3===t.target.nodeType&&(t.target=t.target.parentNode),t},P=function(e){var t=r.createElement("input");return t.setAttribute("type","file"),e in t},H={version:"2.0.2",cors:!1,html5:!0,media:!1,formData:!0,debug:!1,pingUrl:!1,multiFlash:!1,flashAbortTimeout:0,withCredentials:!0,staticPath:"./dist/",flashUrl:0,flashImageUrl:0,postNameConcat:function(e,t){return e+(null!=t?"["+t+"]":"")},ext2mime:{jpg:"image/jpeg",tif:"image/tiff",txt:"text/plain"},accept:{"image/*":"art bm bmp dwg dxf cbr cbz fif fpx gif ico iefs jfif jpe jpeg jpg jps jut mcf nap nif pbm pcx pgm pict pm png pnm qif qtif ras rast rf rp svf tga tif tiff xbm xbm xpm xwd","audio/*":"m4a flac aac rm mpa wav wma ogg mp3 mp2 m3u mod amf dmf dsm far gdm imf it m15 med okt s3m stm sfx ult uni xm sid ac3 dts cue aif aiff wpl ape mac mpc mpp shn wv nsf spc gym adplug adx dsp adp ymf ast afc hps xs","video/*":"m4v 3gp nsv ts ty strm rm rmvb m3u ifo mov qt divx xvid bivx vob nrg img iso pva wmv asf asx ogm m2v avi bin dat dvr-ms mpg mpeg mp4 mkv avc vp3 svq3 nuv viv dv fli flv wpl"},chunkSize:0,chunkUploadRetry:0,chunkNetworkDownRetryTimeout:2e3,KB:k(1),MB:k(2),GB:k(3),TB:k(4),expando:"fileapi"+(new Date).getTime(),uid:function(e){return e?e[H.expando]=e[H.expando]||H.uid():(++n,H.expando+n)},log:function(){H.debug&&e.console&&console.log&&(console.log.apply?console.log.apply(console,arguments):console.log([].join.call(arguments," ")))},newImage:function(e,t){var n=r.createElement("img");return t&&H.event.one(n,"error load",function(e){t("error"==e.type,n),n=null}),n.src=e,n},getXHR:function(){var t;if(f)t=new f;else if(e.ActiveXObject)try{t=new ActiveXObject("MSXML2.XMLHttp.3.0")}catch(n){t=new ActiveXObject("Microsoft.XMLHTTP")}return t},isArray:j,support:{dnd:m&&"ondrop"in r.createElement("div"),cors:m,html5:h,chunked:v,dataURI:!0,accept:P("accept"),multiple:P("multiple")},event:{on:S,off:q,one:D,fix:U},throttle:function(t,n){var i,r;return function(){r=arguments,i||(t.apply(e,r),i=setTimeout(function(){i=0,t.apply(e,r)},n))}},F:function(){},parseJSON:function(t){var n;return n=e.JSON&&JSON.parse?JSON.parse(t):new Function("return ("+t.replace(/([\r\n])/g,"\\$1")+");")(),n},trim:function(e){return e=String(e),e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},defer:function(){var e,n,r=[],a={resolve:function(t,s){a.resolve=i,n=t||!1,e=s;while(s=r.shift())s(n,e)},then:function(i){n!==t?i(n,e):r.push(i)}};return a},queue:function(e){var t=0,n=0,i=!1,r=!1,a={inc:function(){n++},next:function(){t++,setTimeout(a.check,0)},check:function(){t>=n&&!i&&a.end()},isFail:function(){return i},fail:function(){!i&&e(i=!0)},end:function(){r||(r=!0,e())}};return a},each:R,afor:function(e,t){var n=0,i=e.length;j(e)&&i--?function r(){t(i!=n&&r,e[n],n++)}():t(!1)},extend:O,isFile:function(e){return h&&e&&e instanceof c},isCanvas:function(e){return e&&b.test(e.nodeName)},getFilesFilter:function(e){return e="string"==typeof e?e:e.getAttribute&&e.getAttribute("accept")||"",e?new RegExp("("+e.replace(/\./g,"\\.").replace(/,/g,"|")+")$","i"):/./},readAsDataURL:function(e,t){H.isCanvas(e)?$(e,t,"load",H.toDataURL(e)):M(e,t,"DataURL")},readAsBinaryString:function(e,t){B("BinaryString")?M(e,t,"BinaryString"):M(e,function(e){if("load"==e.type)try{e.result=H.toBinaryString(e.result)}catch(n){e.type="error",e.message=n.toString()}t(e)},"DataURL")},readAsArrayBuffer:function(e,t){M(e,t,"ArrayBuffer")},readAsText:function(e,t,n){n||(n=t,t="utf-8"),M(e,n,"Text",t)},toDataURL:function(e,t){return"string"==typeof e?e:e.toDataURL?e.toDataURL(t||"image/png"):void 0},toBinaryString:function(t){return e.atob(H.toDataURL(t).replace(x,""))},readAsImage:function(e,n,i){if(H.isFile(e))if(o){var r=o.createObjectURL(e);r===t?$(e,n,"error"):H.readAsImage(r,n,i)}else H.readAsDataURL(e,function(t){"load"==t.type?H.readAsImage(t.result,n,i):(i||"error"==t.type)&&$(e,n,t,null,{loaded:t.loaded,total:t.total})});else if(H.isCanvas(e))$(e,n,"load",e);else if(y.test(e.nodeName))if(e.complete)$(e,n,"load",e);else{var a="error abort load";D(e,a,function t(i){"load"==i.type&&o&&o.revokeObjectURL(e.src),q(e,a,t),$(e,n,i,e)})}else if(e.iframe)$(e,n,{type:"error"});else{var s=H.newImage(e.dataURL||e);H.readAsImage(s,n,i)}},checkFileObj:function(e){var t={},n=H.accept;return"object"==("undefined"===typeof e?"undefined":babelHelpers.typeof(e))?t=e:t.name=(e+"").split(/\\|\//g).pop(),null==t.type&&(t.type=t.name.split(".").pop()),R(n,function(e,n){e=new RegExp(e.replace(/\s/g,"|"),"i"),(e.test(t.type)||H.ext2mime[t.type])&&(t.type=H.ext2mime[t.type]||n.split("/")[0]+"/"+t.type)}),t},getDropFiles:function(e,t){var n=[],i=G(e),r=j(i.items)&&i.items[0]&&N(i.items[0]),a=H.queue(function(){t(n)});R((r?i.items:i.files)||[],function(e){a.inc();try{r?X(e,function(e,t){e?H.log("[err] getDropFiles:",e):n.push.apply(n,t),a.next()}):z(e,function(t){t&&n.push(e),a.next()})}catch(t){a.next(),H.log("[err] getDropFiles: ",t)}}),a.check()},getFiles:function(e,t,n){var i=[];return n?(H.filterFiles(H.getFiles(e),t,n),null):(e.jquery&&(e.each(function(){i=i.concat(H.getFiles(this))}),e=i,i=[]),"string"==typeof t&&(t=H.getFilesFilter(t)),e.originalEvent?e=U(e.originalEvent):e.srcElement&&(e=U(e)),e.dataTransfer?e=e.dataTransfer:e.target&&(e=e.target),e.files?(i=e.files,h||(i[0].blob=e,i[0].iframe=!0)):!h&&V(e)?H.trim(e.value)&&(i=[H.checkFileObj(e.value)],i[0].blob=e,i[0].iframe=!0):j(e)&&(i=e),H.filter(i,function(e){return!t||t.test(e.name)}))},getTotalSize:function(e){var t=0,n=e&&e.length;while(n--)t+=e[n].size;return t},getInfo:function(e,t){var n={},i=A.concat();H.isFile(e)?function r(){var a=i.shift();a?a.test(e.type)?a(e,function(e,i){e?t(e):(O(n,i),r())}):r():t(!1,n)}():t("not_support_info",n)},addInfoReader:function(e,t){t.test=function(t){return e.test(t)},A.push(t)},filter:function(e,t){for(var n,i=[],r=0,a=e.length;r<a;r++)r in e&&(n=e[r],t.call(n,n,r,e)&&i.push(n));return i},filterFiles:function(e,t,n){if(e.length){var i,r=e.concat(),a=[],s=[];(function e(){r.length?(i=r.shift(),H.getInfo(i,function(n,r){(t(i,!n&&r)?a:s).push(i),e()})):n(a,s)})()}else n([],e)},upload:function(e){e=O({prepare:H.F,beforeupload:H.F,upload:H.F,fileupload:H.F,fileprogress:H.F,filecomplete:H.F,progress:H.F,complete:H.F,pause:H.F,imageOriginal:!0,chunkSize:H.chunkSize,chunkUpoloadRetry:H.chunkUploadRetry},e),e.imageAutoOrientation&&!e.imageTransform&&(e.imageTransform={rotate:"auto"});var t,n=new H.XHR(e),r=this._getFilesDataArray(e.files),a=this,s=0,o=0,l=!1;return R(r,function(e){s+=e.size}),n.files=[],R(r,function(e){n.files.push(e.file)}),n.total=s,n.loaded=0,n.filesLeft=r.length,e.beforeupload(n,e),t=function(){var c=r.shift(),u=c&&c.file,d=!1,f=W(e);n.filesLeft=r.length,u&&u.name===H.expando&&(u=null,H.log("[warn] FileAPI.upload() — called without files")),("abort"!=n.statusText||n.current)&&c?(l=!1,n.currentFile=u,u&&e.prepare(u,f),a._getFormData(f,c,function(l){o||e.upload(n,e);var p=new H.XHR(O({},f,{upload:u?function(){e.fileupload(u,p,f)}:i,progress:u?function(t){d||(e.fileprogress({type:"progress",total:c.total=t.total,loaded:c.loaded=t.loaded},u,p,f),e.progress({type:"progress",total:s,loaded:n.loaded=o+c.size*(t.loaded/t.total)|0},u,p,f))}:i,complete:function(i){d=!0,R(F,function(e){n[e]=p[e]}),u&&(c.loaded=c.total,this.progress(c),o+=c.size,n.loaded=o,e.filecomplete(i,p,u,f)),t.call(a)}}));n.abort=function(e){e||(r.length=0),this.current=e,p.abort()},p.send(l)})):(e.complete(200!=n.status&&201!=n.status&&(n.statusText||"error"),n,e),l=!0)},setTimeout(t,0),n.append=function(e,i){e=H._getFilesDataArray([].concat(e)),R(e,function(e){s+=e.size,n.files.push(e.file),i?r.unshift(e):r.push(e)}),n.statusText="",l&&t.call(a)},n.remove=function(e){var t,n=r.length;while(n--)r[n].file==e&&(t=r.splice(n,1),s-=t.size);return t},n},_getFilesDataArray:function(e){var t=[],n={};if(V(e)){var i=H.getFiles(e);n[e.name||"file"]=null!==e.getAttribute("multiple")?i:i[0]}else j(e)&&V(e[0])?R(e,function(e){n[e.name||"file"]=H.getFiles(e)}):n=e;return R(n,function e(n,i){j(n)?R(n,function(t){e(t,i)}):n&&(n.name||n.image)&&t.push({name:i,file:n,size:n.size,total:n.size,loaded:0})}),t.length||t.push({file:{name:H.expando}}),t},_getFormData:function(e,t,n){var i=t.file,r=t.name,a=i.name,s=i.type,o=H.support.transform&&e.imageTransform,l=new H.Form,c=H.queue(function(){n(l)}),u=o&&J(o),d=H.postNameConcat;(function t(n){n.image?(c.inc(),n.toData(function(e,n){a=a||(new Date).getTime()+".png",t(n),c.next()})):H.Image&&o&&(/^image/.test(n.type)||w.test(n.nodeName))?(c.inc(),u&&(o=[o]),H.Image.transform(n,o,e.imageAutoOrientation,function(t,i){if(u&&!t)g||H.flashEngine||(l.multipart=!0),l.append(r,i[0],a,o[0].type||s);else{var f=0;t||R(i,function(e,t){g||H.flashEngine||(l.multipart=!0),o[t].postName||(f=1),l.append(o[t].postName||d(r,t),e,a,o[t].type||s)}),(t||e.imageOriginal)&&l.append(d(r,f?"original":null),n,a,s)}c.next()})):a!==H.expando&&l.append(r,n,a)})(i),R(e.data,function e(t,n){"object"==("undefined"===typeof t?"undefined":babelHelpers.typeof(t))?R(t,function(t,i){e(t,d(n,i))}):l.append(n,t)}),c.check()},reset:function(e,t){var n,i;return p?(i=p(e).clone(!0).insertBefore(e).val("")[0],t||p(e).remove()):(n=e.parentNode,i=n.insertBefore(e.cloneNode(!0),e),i.value="",t||n.removeChild(e),R(E[H.uid(e)],function(t,n){R(t,function(t){q(e,n,t),S(i,n,t)})})),i},load:function(e,t){var n=H.getXHR();return n?(n.open("GET",e,!0),n.overrideMimeType&&n.overrideMimeType("text/plain; charset=x-user-defined"),S(n,"progress",function(e){e.lengthComputable&&t({type:e.type,loaded:e.loaded,total:e.total},n)}),n.onreadystatechange=function(){if(4==n.readyState)if(n.onreadystatechange=null,200==n.status){e=e.split("/");var i={name:e[e.length-1],size:n.getResponseHeader("Content-Length"),type:n.getResponseHeader("Content-Type")};i.dataURL="data:"+i.type+";base64,"+H.encode64(n.responseBody||n.responseText),t({type:"load",result:i},n)}else t({type:"error"},n)},n.send(null)):t({type:"error"}),n},encode64:function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="",i=0;"string"!==typeof e&&(e=String(e));while(i<e.length){var r,a,s=255&e.charCodeAt(i++),o=255&e.charCodeAt(i++),l=255&e.charCodeAt(i++),c=s>>2,u=(3&s)<<4|o>>4;isNaN(o)?r=a=64:(r=(15&o)<<2|l>>6,a=isNaN(l)?64:63&l),n+=t.charAt(c)+t.charAt(u)+t.charAt(r)+t.charAt(a)}return n}};function $(e,t,n,i,r){var a={type:n.type||n,target:e,result:i};O(a,r),t(a)}function B(e){return u&&!!u.prototype["readAs"+e]}function M(e,n,i,r){if(H.isFile(e)&&B(i)){var a=new u;S(a,I,function t(i){var r=i.type;"progress"==r?$(e,n,i,i.target.result,{loaded:i.loaded,total:i.total}):"loadend"==r?(q(a,I,t),a=null):$(e,n,i,i.target.result)});try{r?a["readAs"+i](e,r):a["readAs"+i](e)}catch(s){$(e,n,"error",t,{error:s.toString()})}}else $(e,n,"error",t,{error:"filreader_not_support_"+i})}function z(e,t){if(!e.type&&e.size%4096===0&&e.size<=102400)if(u)try{var n=new u;D(n,I,function(e){var i="error"!=e.type;t(i),i&&n.abort()}),n.readAsDataURL(e)}catch(i){t(!1)}else t(null);else t(!0)}function N(e){var t;return e.getAsEntry?t=e.getAsEntry():e.webkitGetAsEntry&&(t=e.webkitGetAsEntry()),t}function X(e,t){if(e)if(e.isFile)e.file(function(n){n.fullPath=e.fullPath,t(!1,[n])},function(e){t("FileError.code: "+e.code)});else if(e.isDirectory){var n=e.createReader(),i=[];n.readEntries(function(e){H.afor(e,function(e,n){X(n,function(n,r){n?H.log(n):i=i.concat(r),e?e():t(!1,i)})})},function(e){t("directory_reader: "+e)})}else X(N(e),t);else t("invalid entry")}function W(e){var t={};return R(e,function(e,n){e&&"object"===("undefined"===typeof e?"undefined":babelHelpers.typeof(e))&&void 0===e.nodeType&&(e=O({},e)),t[n]=e}),t}function V(e){return _.test(e&&e.tagName)}function G(e){return(e.originalEvent||e||"").dataTransfer||{}}function J(e){var t;for(t in e)if(e.hasOwnProperty(t)&&!(e[t]instanceof Object||"overlay"===t||"filter"===t))return!0;return!1}H.addInfoReader(/^image/,function(e,t){if(!e.__dimensions){var n=e.__dimensions=H.defer();H.readAsImage(e,function(e){var t=e.target;n.resolve("load"!=e.type&&"error",{width:t.width,height:t.height}),t=null})}e.__dimensions.then(t)}),H.event.dnd=function(e,t,n){var i,r;n||(n=t,t=H.F),u?(S(e,"dragenter dragleave dragover",function(e){var n=G(e).types,a=n&&n.length,s=!1;while(a--)if(~n[a].indexOf("File")){e[L](),r!==e.type&&(r=e.type,"dragleave"!=r&&t.call(e[T],!0,e),s=!0);break}s&&(clearTimeout(i),i=setTimeout(function(){t.call(e[T],"dragleave"!=r,e)},50))}),S(e,"drop",function(e){e[L](),r=0,t.call(e[T],!1,e),H.getDropFiles(e,function(t){n.call(e[T],t,e)})})):H.log("Drag'n'Drop -- not supported")},H.event.dnd.off=function(e,t,n){q(e,"dragenter dragleave dragover",t),q(e,"drop",n)},p&&!p.fn.dnd&&(p.fn.dnd=function(e,t){return this.each(function(){H.event.dnd(this,e,t)})},p.fn.offdnd=function(e,t){return this.each(function(){H.event.dnd.off(this,e,t)})}),e.FileAPI=O(H,e.FileAPI),H.log("FileAPI: "+H.version),H.log("protocol: "+e.location.protocol),H.log("doctype: ["+a.name+"] "+a.publicId+" "+a.systemId),R(r.getElementsByTagName("meta"),function(e){/x-ua-compatible/i.test(e.getAttribute("http-equiv"))&&H.log("meta.http-equiv: "+e.getAttribute("content"))}),H.flashUrl||(H.flashUrl=H.staticPath+"FileAPI.flash.swf"),H.flashImageUrl||(H.flashImageUrl=H.staticPath+"FileAPI.flash.image.swf"),H.flashWebcamUrl||(H.flashWebcamUrl=H.staticPath+"FileAPI.flash.camera.swf")}(window,void 0),function(e,t,n){var i=Math.min,r=Math.round,a=function(){return t.createElement("canvas")},s=!1,o={8:270,3:180,6:90};try{s=a().toDataURL("image/png").indexOf("data:image/png")>-1}catch(c){}function l(t){if(t instanceof l){var n=new l(t.file);return e.extend(n.matrix,t.matrix),n}if(!(this instanceof l))return new l(t);this.file=t,this.matrix={sx:0,sy:0,sw:0,sh:0,dx:0,dy:0,dw:0,dh:0,resize:0,deg:0,quality:1,filter:0}}l.prototype={image:!0,constructor:l,set:function(t){return e.extend(this.matrix,t),this},crop:function(e,t,i,r){return i===n&&(i=e,r=t,e=t=0),this.set({sx:e,sy:t,sw:i,sh:r||i})},resize:function(e,t,n){return"string"==typeof t&&(n=t,t=e),this.set({dw:e,dh:t,resize:n})},preview:function(e,t){return this.resize(e,t||e,"preview")},rotate:function(e){return this.set({deg:e})},filter:function(e){return this.set({filter:e})},overlay:function(e){return this.set({overlay:e})},clone:function(){return new l(this)},_load:function(t,n){var i=this;/img|video/i.test(t.nodeName)?n.call(i,null,t):e.readAsImage(t,function(e){n.call(i,"load"!=e.type,e.result)})},_apply:function(t,n){var r,s=a(),o=this.getMatrix(t),c=s.getContext("2d"),u=t.videoWidth||t.width,d=t.videoHeight||t.height,f=o.deg,p=o.dw,h=o.dh,m=u,v=d,g=o.filter,y=t,b=o.overlay,w=e.queue(function(){n(!1,s)}),_=e.renderImageToCanvas;t._type=this.file.type;while(i(m/p,v/h)>2)m=m/2+.5|0,v=v/2+.5|0,r=a(),r.width=m,r.height=v,y!==t?(_(r,y,0,0,y.width,y.height,0,0,m,v),y=r):(y=r,_(y,t,o.sx,o.sy,o.sw,o.sh,0,0,m,v),o.sx=o.sy=o.sw=o.sh=0);s.width=f%180?h:p,s.height=f%180?p:h,s.type=o.type,s.quality=o.quality,c.rotate(f*Math.PI/180),_(s,y,o.sx,o.sy,o.sw||y.width,o.sh||y.height,180==f||270==f?-p:0,90==f||180==f?-h:0,p,h),p=s.width,h=s.height,b&&e.each([].concat(b),function(t){w.inc();var n=new window.Image,i=function i(){var r=0|t.x,a=0|t.y,s=t.w||n.width,o=t.h||n.height,l=t.rel;r=1==l||4==l||7==l?(p-s+r)/2:2==l||5==l||8==l?p-(s+r):r,a=3==l||4==l||5==l?(h-o+a)/2:l>=6?h-(o+a):a,e.event.off(n,"error load abort",i);try{c.globalAlpha=t.opacity||1,c.drawImage(n,r,a,s,o)}catch(u){}w.next()};e.event.on(n,"error load abort",i),n.src=t.src,n.complete&&i()}),g&&(w.inc(),l.applyFilter(s,g,w.next)),w.check()},getMatrix:function(t){var n,a,s=e.extend({},this.matrix),o=s.sw=s.sw||t.videoWidth||t.naturalWidth||t.width,l=s.sh=s.sh||t.videoHeight||t.naturalHeight||t.height,c=s.dw=s.dw||o,u=s.dh=s.dh||l,d=o/l,f=c/u,p=s.resize;"preview"==p?c==o&&u==l||(f>=d?(n=o,a=n/f):(a=l,n=a*f),n==o&&a==l||(s.sx=~~((o-n)/2),s.sy=~~((l-a)/2),o=n,l=a)):p&&(o>c||l>u?"min"==p?(c=r(d<f?i(o,c):u*d),u=r(d<f?c/d:i(l,u))):(c=r(d>=f?i(o,c):u*d),u=r(d>=f?c/d:i(l,u))):(c=o,u=l));return s.sw=o,s.sh=l,s.dw=c,s.dh=u,s},_trans:function(e){this._load(this.file,function(t,n){t?e(t):this._apply(n,e)})},get:function(t){if(e.support.transform){var n=this,i=n.matrix;"auto"==i.deg?e.getInfo(n.file,function(e,r){i.deg=o[r&&r.exif&&r.exif.Orientation]||0,n._trans(t)}):n._trans(t)}else t("not_support_transform")},toData:function(e){this.get(e)}},l.exifOrientation=o,l.transform=function(t,i,r,a){function s(s,o){var c={},u=e.queue(function(e){a(e,c)});s?u.fail():e.each(i,function(e,i){if(!u.isFail()){var a=new l(o.nodeType?o:t);if("function"==typeof e?e(o,a):e.width?a[e.preview?"preview":"resize"](e.width,e.height,e.type):e.maxWidth&&(o.width>e.maxWidth||o.height>e.maxHeight)&&a.resize(e.maxWidth,e.maxHeight,"max"),e.crop){var s=e.crop;a.crop(0|s.x,0|s.y,s.w||s.width,s.h||s.height)}e.rotate===n&&r&&(e.rotate="auto"),a.set({deg:e.rotate,type:e.type||t.type||"image/png",quality:e.quality||1,overlay:e.overlay,filter:e.filter}),u.inc(),a.toData(function(e,t){e?u.fail():(c[i]=t,u.next())})}})}t.width?s(!1,t):e.getInfo(t,s)},e.each(["TOP","CENTER","BOTTOM"],function(t,n){e.each(["LEFT","CENTER","RIGHT"],function(e,i){l[t+"_"+e]=3*n+i,l[e+"_"+t]=3*n+i})}),l.toCanvas=function(e){var n=t.createElement("canvas");return n.width=e.videoWidth||e.width,n.height=e.videoHeight||e.height,n.getContext("2d").drawImage(e,0,0),n},l.fromDataURL=function(t,n,i){var r=e.newImage(t);e.extend(r,n),i(r)},l.applyFilter=function(t,n,i){"function"==typeof n?n(t,i):window.Caman&&window.Caman("IMG"==t.tagName?l.toCanvas(t):t,function(){"string"==typeof n?this[n]():e.each(n,function(e,t){this[t](e)},this),this.render(i)})},e.renderImageToCanvas=function(e,t,n,i,r,a,s,o,l,c){return e.getContext("2d").drawImage(t,n,i,r,a,s,o,l,c),e},e.support.canvas=e.support.transform=s,e.Image=l}(FileAPI,document),function(e,t){var n=t.document,i=t.FormData,r=function(){this.items=[]},a=t.encodeURIComponent;function s(t,n,i){var r=t.blob,a=t.file;if(a){if(!r.toDataURL)return void e.readAsBinaryString(r,function(e){"load"==e.type&&n(t,e.result)});var s={"image/jpeg":".jpe?g","image/png":".png"},o=s[t.type]?t.type:"image/png",l=s[o]||".png",c=r.quality||1;a.match(new RegExp(l+"$","i"))||(a+=l.replace("?","")),t.file=a,t.type=o,!i&&r.toBlob?r.toBlob(function(e){n(t,e)},o,c):n(t,e.toBinaryString(r.toDataURL(o,c)))}else n(t,r)}r.prototype={append:function(e,t,n,i){this.items.push({name:e,blob:t&&t.blob||(void 0==t?"":t),file:t&&(n||t.name),type:t&&(i||t.type)})},each:function(e){for(var t=0,n=this.items.length;t<n;t++)e.call(this,this.items[t])},toData:function(t,n){n._chunked=e.support.chunked&&n.chunkSize>0&&1==e.filter(this.items,function(e){return e.file}).length,e.support.html5?e.formData&&!this.multipart&&i?n._chunked?(e.log("FileAPI.Form.toPlainData"),this.toPlainData(t)):(e.log("FileAPI.Form.toFormData"),this.toFormData(t)):(e.log("FileAPI.Form.toMultipartData"),this.toMultipartData(t)):(e.log("FileAPI.Form.toHtmlData"),this.toHtmlData(t))},_to:function(t,n,i,r){var a=e.queue(function(){n(t)});this.each(function(e){i(e,t,a,r)}),a.check()},toHtmlData:function(t){this._to(n.createDocumentFragment(),t,function(t,i){var r,a=t.blob;t.file?(e.reset(a,!0),a.name=t.name,i.appendChild(a)):(r=n.createElement("input"),r.name=t.name,r.type="hidden",r.value=a,i.appendChild(r))})},toPlainData:function(e){this._to({},e,function(e,t,n){e.file&&(t.type=e.file),e.blob.toBlob?(n.inc(),s(e,function(e,i){t.name=e.name,t.file=i,t.size=i.length,t.type=e.type,n.next()})):e.file?(t.name=e.blob.name,t.file=e.blob,t.size=e.blob.size,t.type=e.type):(t.params||(t.params=[]),t.params.push(a(e.name)+"="+a(e.blob))),t.start=-1,t.end=t.file&&t.file.FileAPIReadPosition||-1,t.retry=0})},toFormData:function(e){this._to(new i,e,function(e,t,n){e.blob&&e.blob.toBlob?(n.inc(),s(e,function(e,i){t.append(e.name,i,e.file),n.next()})):e.file?t.append(e.name,e.blob,e.file):t.append(e.name,e.blob),e.file&&t.append("_"+e.name,e.file)})},toMultipartData:function(t){this._to([],t,function(e,t,n,i){n.inc(),s(e,function(e,r){t.push("--_"+i+'\r\nContent-Disposition: form-data; name="'+e.name+'"'+(e.file?'; filename="'+a(e.file)+'"':"")+(e.file?"\r\nContent-Type: "+(e.type||"application/octet-stream"):"")+"\r\n\r\n"+(e.file?r:a(r))+"\r\n"),n.next()},!0)},e.expando)}},e.Form=r}(FileAPI,window),function(e,t){var n=function(){},i=e.document,r=function(e){this.uid=t.uid(),this.xhr={abort:n,getResponseHeader:n,getAllResponseHeaders:n},this.options=e},a={"":1,XML:1,Text:1,Body:1};r.prototype={status:0,statusText:"",constructor:r,getResponseHeader:function(e){return this.xhr.getResponseHeader(e)},getAllResponseHeaders:function(){return this.xhr.getAllResponseHeaders()||{}},end:function(i,r){var a=this,s=a.options;a.end=a.abort=n,a.status=i,r&&(a.statusText=r),t.log("xhr.end:",i,r),s.complete(200!=i&&201!=i&&(a.statusText||"unknown"),a),a.xhr&&a.xhr.node&&setTimeout(function(){var t=a.xhr.node;try{t.parentNode.removeChild(t)}catch(n){}try{delete e[a.uid]}catch(n){}e[a.uid]=a.xhr.node=null},9)},abort:function(){this.end(0,"abort"),this.xhr&&(this.xhr.aborted=!0,this.xhr.abort())},send:function(e){var t=this,n=this.options;e.toData(function(e){n.upload(n,t),t._send.call(t,n,e)},n)},_send:function(n,r){var s,o=this,l=o.uid,c=n.url;if(t.log("XHR._send:",r),n.cache||(c+=(~c.indexOf("?")?"&":"?")+t.uid()),r.nodeName){n.upload(n,o),s=i.createElement("div"),s.innerHTML='<form target="'+l+'" action="'+c+'" method="POST" enctype="multipart/form-data" style="position: absolute; top: -1000px; overflow: hidden; width: 1px; height: 1px;"><iframe name="'+l+'" src="javascript:false;"></iframe><input value="'+l+'" name="callback" type="hidden"/></form>',o.xhr.abort=function(){var e=s.getElementsByTagName("iframe")[0];if(e)try{e.stop?e.stop():e.contentWindow.stop?e.contentWindow.stop():e.contentWindow.document.execCommand("Stop")}catch(t){}s=null};var u=s.getElementsByTagName("form")[0];u.appendChild(r),t.log(u.parentNode.innerHTML),i.body.appendChild(s),o.xhr.node=s,e[l]=function(e,t,n){o.readyState=4,o.responseText=n,o.end(e,t),s=null},o.readyState=2,u.submit(),u=null}else{if(this.xhr&&this.xhr.aborted)return void t.log("Error: already aborted");var d;if(s=o.xhr=t.getXHR(),r.params&&(c+=(c.indexOf("?")<0?"?":"&")+r.params.join("&")),s.open("POST",c,!0),t.withCredentials&&(s.withCredentials="true"),n.headers&&n.headers["X-Requested-With"]||s.setRequestHeader("X-Requested-With","XMLHttpRequest"),t.each(n.headers,function(e,t){s.setRequestHeader(t,e)}),n._chunked)s.upload&&s.upload.addEventListener("progress",function(e){r.retry||n.progress({type:e.type,total:r.size,loaded:r.start+e.loaded,totalSize:r.size},o,n)},!1),s.onreadystatechange=function(){var e=parseInt(s.getResponseHeader("X-Last-Known-Byte"),10);if(o.status=s.status,o.statusText=s.statusText,o.readyState=s.readyState,4==s.readyState){for(var i in a)o["response"+i]=s["response"+i];if(s.onreadystatechange=null,!s.status||s.status-201>0)if(t.log("Error: "+s.status),(!s.status&&!s.aborted||500==s.status||416==s.status)&&++r.retry<=n.chunkUploadRetry){var l=s.status?0:t.chunkNetworkDownRetryTimeout;n.pause(r.file,n),t.log("X-Last-Known-Byte: "+e),r.end=e||r.start-1,setTimeout(function(){o._send(n,r)},l)}else o.end(s.status);else r.retry=0,r.end==r.size-1?o.end(s.status):(t.log("X-Last-Known-Byte: "+e),e&&(r.end=e),r.file.FileAPIReadPosition=r.end,setTimeout(function(){o._send(n,r)},0));s=null}},r.start=r.end+1,r.end=Math.max(Math.min(r.start+n.chunkSize,r.size)-1,r.start),(d="slice")in r.file||(d="mozSlice")in r.file||(d="webkitSlice",r.file),s.setRequestHeader("Content-Range","bytes "+r.start+"-"+r.end+"/"+r.size),s.setRequestHeader("Content-Disposition","attachment; filename="+encodeURIComponent(r.name)),s.setRequestHeader("Content-Type",r.type||"application/octet-stream"),d=r.file[d](r.start,r.end+1),s.send(d),d=null;else if(s.upload&&s.upload.addEventListener("progress",t.throttle(function(e){n.progress(e,o,n)},100),!1),s.onreadystatechange=function(){if(o.status=s.status,o.statusText=s.statusText,o.readyState=s.readyState,4==s.readyState){for(var e in a)o["response"+e]=s["response"+e];s.onreadystatechange=null,o.end(s.status),s=null}},t.isArray(r))if(s.setRequestHeader("Content-Type","multipart/form-data; boundary=_"+t.expando),r=r.join("")+"--_"+t.expando+"--",s.sendAsBinary)s.sendAsBinary(r);else{var f=Array.prototype.map.call(r,function(e){return 255&e.charCodeAt(0)});s.send(new Uint8Array(f).buffer)}else s.send(r)}}},t.XHR=r}(window,FileAPI),function(e,t){var n=e.URL||e.webkitURL,i=e.document,r=e.navigator,a=r.getUserMedia||r.webkitGetUserMedia||r.mozGetUserMedia||r.msGetUserMedia,s=!!a;t.support.media=s;var o=function(e){this.video=e};o.prototype={isActive:function(){return!!this._active},start:function(e){var t,i,s=this,o=s.video,l=function(n){s._active=!n,clearTimeout(i),clearTimeout(t),e&&e(n,s)};a.call(r,{video:!0},function(e){s.stream=e,o.src=n.createObjectURL(e),t=setInterval(function(){u(o)&&l(null)},1e3),i=setTimeout(function(){l("timeout")},5e3),o.play()},l)},stop:function(){try{this._active=!1,this.video.pause(),this.stream.stop()}catch(e){}},shot:function(){return new l(this.video)}},o.get=function(e){return new o(e.firstChild)},o.publish=function(n,r,a){"function"==typeof r&&(a=r,r={}),r=t.extend({},{width:"100%",height:"100%",start:!0},r),n.jquery&&(n=n[0]);var l=function(e){if(e)a(e);else{var t=o.get(n);r.start?t.start(a):a(null,t)}};if(n.style.width=c(r.width),n.style.height=c(r.height),t.html5&&s){var u=i.createElement("video");u.style.width=c(r.width),u.style.height=c(r.height),e.jQuery?jQuery(n).empty():n.innerHTML="",n.appendChild(u),l()}else o.fallback(n,r,l)},o.fallback=function(e,t,n){n("not_support_camera")};var l=function(e){var n=e.nodeName?t.Image.toCanvas(e):e,i=t.Image(n);return i.type="image/png",i.width=n.width,i.height=n.height,i.size=n.width*n.height*4,i};function c(e){return e>=0?e+"px":e}function u(e){var t,n=i.createElement("canvas"),r=!1;try{t=n.getContext("2d"),t.drawImage(e,0,0,1,1),r=255!=t.getImageData(0,0,1,1).data[4]}catch(a){}return r}o.Shot=l,t.Camera=o}(window,FileAPI),function(e,t,n){var i=e.document,r=e.location,a=e.navigator,s=n.each,o=[];n.support.flash=function(){var t=a.mimeTypes,i=!1;if(a.plugins&&"object"==babelHelpers.typeof(a.plugins["Shockwave Flash"]))i=a.plugins["Shockwave Flash"].description&&!(t&&t["application/x-shockwave-flash"]&&!t["application/x-shockwave-flash"].enabledPlugin);else try{i=!(!e.ActiveXObject||!new ActiveXObject("ShockwaveFlash.ShockwaveFlash"))}catch(s){n.log("Flash -- does not supported.")}return i&&/^file:/i.test(r)&&n.log("[warn] Flash does not work on `file:` protocol."),i}(),n.support.flash&&(!n.html5||!n.support.html5||n.cors&&!n.support.cors||n.media&&!n.support.media)&&function(){var l=n.uid(),c=0,u={},d=/^https?:/i,f={_fn:{},init:function(){var e=i.body&&i.body.firstChild;if(e)do{if(1==e.nodeType){n.log("FlashAPI.state: awaiting");var t=i.createElement("div");return t.id="_"+l,h(t,{top:1,right:1,width:5,height:5,position:"absolute",zIndex:1e6+""}),e.parentNode.insertBefore(t,e),void f.publish(t,l)}}while(e=e.nextSibling);c<10&&setTimeout(f.init,50*++c)},publish:function(e,t,i){i=i||{},e.innerHTML=p({id:t,src:b(n.flashUrl,"r="+n.version),wmode:i.camera?"":"transparent",flashvars:"callback="+(i.onEvent||"FileAPI.Flash.onEvent")+"&flashId="+t+"&storeKey="+a.userAgent.match(/\d/gi).join("")+"_"+n.version+(f.isReady||(n.pingUrl?"&ping="+n.pingUrl:""))+"&timeout="+n.flashAbortTimeout+(i.camera?"&useCamera="+b(n.flashWebcamUrl):"")},i)},ready:function(){n.log("FlashAPI.state: ready"),f.ready=n.F,f.isReady=!0,f.patch(),n.event.on(i,"mouseover",f.mouseover),n.event.on(i,"click",function(e){f.mouseover(e)&&(e.preventDefault?e.preventDefault():e.returnValue=!0)})},getEl:function(){return i.getElementById("_"+l)},getWrapper:function(e){do{if(/js-fileapi-wrapper/.test(e.className))return e}while((e=e.parentNode)&&e!==i.body)},mouseover:function(e){var t=n.event.fix(e).target;if(/input/i.test(t.nodeName)&&"file"==t.type){var r=t.getAttribute(l),a=f.getWrapper(t);if(n.multiFlash){if("i"==r||"r"==r)return!1;if("p"!=r){t.setAttribute(l,"i");var s=i.createElement("div");if(!a)return void n.log("[err] FlashAPI.mouseover: js-fileapi-wrapper not found");h(s,{top:0,left:0,width:t.offsetWidth+100,height:t.offsetHeight+100,zIndex:1e6+"",position:"absolute"}),a.appendChild(s),f.publish(s,n.uid()),t.setAttribute(l,"p")}return!0}if(a){var o=x(a);h(f.getEl(),o),f.curInp=t}}else/object|embed/i.test(t.nodeName)||h(f.getEl(),{top:1,left:1,width:5,height:5})},onEvent:function(e){var t=e.type;if("ready"==t){try{f.getInput(e.flashId).setAttribute(l,"r")}catch(i){}return f.ready(),setTimeout(function(){f.mouseenter(e)},50),!0}"ping"===t?n.log("(flash -> js).ping:",[e.status,e.savedStatus],e.error):"log"===t?n.log("(flash -> js).log:",e.target):t in f&&setTimeout(function(){n.log("FlashAPI.event."+e.type+":",e),f[t](e)},1)},mouseenter:function(e){var t=f.getInput(e.flashId);if(t){f.cmd(e,"multiple",null!=t.getAttribute("multiple"));var i=[],r={};s((t.getAttribute("accept")||"").split(/,\s*/),function(e){n.accept[e]&&s(n.accept[e].split(" "),function(e){r[e]=1})}),s(r,function(e,t){i.push(t)}),f.cmd(e,"accept",i.length?i.join(",")+","+i.join(",").toUpperCase():"*")}},get:function(t){return i[t]||e[t]||i.embeds[t]},getInput:function(e){if(!n.multiFlash)return f.curInp;try{var t=f.getWrapper(f.get(e));if(t)return t.getElementsByTagName("input")[0]}catch(i){n.log('[err] Can not find "input" by flashId:',e,i)}},select:function(e){var r,a=f.getInput(e.flashId),o=n.uid(a),l=e.target.files;s(l,function(e){n.checkFileObj(e)}),u[o]=l,i.createEvent?(r=i.createEvent("Event"),r.files=l,r.initEvent("change",!0,!0),a.dispatchEvent(r)):t?t(a).trigger({type:"change",files:l}):(r=i.createEventObject(),r.files=l,a.fireEvent("onchange",r))},cmd:function(e,t,i,r){try{return n.log("(js -> flash)."+t+":",i),f.get(e.flashId||e).cmd(t,i)}catch(a){n.log("(js -> flash).onError:",a),r||setTimeout(function(){f.cmd(e,t,i,!0)},50)}},patch:function(){n.flashEngine=n.support.transform=!0,m(n,{getFiles:function(e,t,i){if(i)return n.filterFiles(n.getFiles(e),t,i),null;var r=n.isArray(e)?e:u[n.uid(e.target||e.srcElement||e)];return r?(t&&(t=n.getFilesFilter(t),r=n.filter(r,function(e){return t.test(e.name)})),r):this.parent.apply(this,arguments)},getInfo:function(e,t){if(v(e))this.parent.apply(this,arguments);else if(e.isShot)t(null,e.info={width:e.width,height:e.height});else{if(!e.__info){var i=e.__info=n.defer();f.cmd(e,"getFileInfo",{id:e.id,callback:g(function t(n,r){y(t),i.resolve(n,e.info=r)})})}e.__info.then(t)}}}),n.support.transform=!0,n.Image&&m(n.Image.prototype,{get:function(e,t){this.set({scaleMode:t||"noScale"}),this.parent(e)},_load:function(e,t){if(n.log("FlashAPI.Image._load:",e),v(e))this.parent.apply(this,arguments);else{var i=this;n.getInfo(e,function(n){t.call(i,n,e)})}},_apply:function(e,t){if(n.log("FlashAPI.Image._apply:",e),v(e))this.parent.apply(this,arguments);else{var i=this.getMatrix(e.info),r=t;f.cmd(e,"imageTransform",{id:e.id,matrix:i,callback:g(function a(s,o){n.log("FlashAPI.Image._apply.callback:",s),y(a),s?r(s):n.support.html5||n.support.dataURI&&!(o.length>3e4)?(i.filter&&(r=function(e,r){e?t(e):n.Image.applyFilter(r,i.filter,function(){t(e,this.canvas)})}),n.newImage("data:"+e.type+";base64,"+o,r)):w({width:i.deg%180?i.dh:i.dw,height:i.deg%180?i.dw:i.dh,scale:i.scaleMode},o,r)})})}},toData:function(e){var t=this.file,i=t.info,r=this.getMatrix(i);v(t)?this.parent.apply(this,arguments):("auto"==r.deg&&(r.deg=n.Image.exifOrientation[i&&i.exif&&i.exif.Orientation]||0),e.call(this,!t.info,{id:t.id,flashId:t.flashId,name:t.name,type:t.type,matrix:r}))}}),n.Image&&m(n.Image,{fromDataURL:function(e,t,i){!n.support.dataURI||e.length>3e4?w(n.extend({scale:"exactFit"},t),e.replace(/^data:[^,]+,/,""),function(e,t){i(t)}):this.parent(e,t,i)}}),n.Camera.fallback=function(e,t,i){var r=n.uid();n.log("FlashAPI.Camera.publish: "+r),f.publish(e,r,n.extend(t,{camera:!0,onEvent:g(function e(t){"camera"==t.type&&(y(e),t.error?(n.log("FlashAPI.Camera.publish.error: "+t.error),i(t.error)):(n.log("FlashAPI.Camera.publish.success: "+r),i(null)))})}))},s(o,function(e){n.Camera.fallback.apply(n.Camera,e)}),o=[],m(n.Camera.prototype,{_id:function(){return this.video.id},start:function(e){var t=this;f.cmd(this._id(),"camera.on",{callback:g(function i(r){y(i),r.error?(n.log("FlashAPI.camera.on.error: "+r.error),e(r.error,t)):(n.log("FlashAPI.camera.on.success: "+t._id()),t._active=!0,e(null,t))})})},stop:function(){this._active=!1,f.cmd(this._id(),"camera.off")},shot:function(){n.log("FlashAPI.Camera.shot:",this._id());var e=f.cmd(this._id(),"shot",{});return e.type="image/png",e.flashId=this._id(),e.isShot=!0,new n.Camera.Shot(e)}}),m(n.Form.prototype,{toData:function(e){for(var t=this.items,i=t.length;i--;)if(t[i].file&&v(t[i].blob))return this.parent.apply(this,arguments);n.log("FlashAPI.Form.toData"),e(t)}}),m(n.XHR.prototype,{_send:function(e,t){if(t.nodeName||t.append&&n.support.html5||n.isArray(t)&&"string"===typeof t[0])return this.parent.apply(this,arguments);var i,r,a={},o={},c=this;if(s(t,function(e){e.file?(o[e.name]=e=_(e.blob),r=e.id,i=e.flashId):a[e.name]=e.blob}),r||(i=l),!i)return n.log("[err] FlashAPI._send: flashId -- undefined"),this.parent.apply(this,arguments);n.log("FlashAPI.XHR._send: "+i+" -> "+r,o),c.xhr={headers:{},abort:function(){f.cmd(i,"abort",{id:r})},getResponseHeader:function(e){return this.headers[e]},getAllResponseHeaders:function(){return this.headers}};var u=n.queue(function(){f.cmd(i,"upload",{url:b(e.url),data:a,files:r?o:null,headers:e.headers||{},callback:g(function t(i){var r=i.type,a=i.result;n.log("FlashAPI.upload."+r+":",i),"progress"==r?(i.loaded=Math.min(i.loaded,i.total),i.lengthComputable=!0,e.progress(i)):"complete"==r?(y(t),"string"==typeof a&&(c.responseText=a.replace(/%22/g,'"').replace(/%5c/g,"\\").replace(/%26/g,"&").replace(/%25/g,"%")),c.end(i.status||200)):"abort"!=r&&"error"!=r||(c.end(i.status||0,i.message),y(t))})})});s(o,function(e){u.inc(),n.getInfo(e,u.next)}),u.check()}})}};function p(e){return('<object id="#id#" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+(e.width||"100%")+'" height="'+(e.height||"100%")+'"><param name="movie" value="#src#" /><param name="flashvars" value="#flashvars#" /><param name="swliveconnect" value="true" /><param name="allowscriptaccess" value="always" /><param name="allownetworking" value="all" /><param name="menu" value="false" /><param name="wmode" value="#wmode#" /><embed flashvars="#flashvars#" swliveconnect="true" allownetworking="all" allowscriptaccess="always" name="#id#" src="#src#" width="'+(e.width||"100%")+'" height="'+(e.height||"100%")+'" menu="false" wmode="transparent" type="application/x-shockwave-flash"></embed></object>').replace(/#(\w+)#/gi,function(t,n){return e[n]})}function h(e,t){var n,i;if(e&&e.style)for(n in t){i=t[n],"number"==typeof i&&(i+="px");try{e.style[n]=i}catch(r){}}}function m(e,t){s(t,function(t,n){var i=e[n];e[n]=function(){return this.parent=i,t.apply(this,arguments)}})}function v(e){return e&&!e.flashId}function g(e){var t=e.wid=n.uid();return f._fn[t]=e,"FileAPI.Flash._fn."+t}function y(e){try{f._fn[e.wid]=null,delete f._fn[e.wid]}catch(t){}}function b(e,t){if(!d.test(e)){if(/^\.\//.test(e)||"/"!=e.charAt(0)){var n=r.pathname;n=n.substr(0,n.lastIndexOf("/")),e=(n+"/"+e).replace("/./","/")}"//"!=e.substr(0,2)&&(e="//"+r.host+e),d.test(e)||(e=r.protocol+e)}return t&&(e+=(/\?/.test(e)?"&":"?")+t),e}function w(e,t,r){var a,s=n.uid(),o=i.createElement("div"),l=10;for(a in e)o.setAttribute(a,e[a]),o[a]=e[a];function c(){try{var e=f.get(s);e.setImage(t)}catch(i){n.log('[err] FlashAPI.Preview.setImage -- can not set "base64":',i)}}h(o,e),e.width="100%",e.height="100%",o.innerHTML=p(n.extend({id:s,src:b(n.flashImageUrl,"r="+n.uid()),wmode:"opaque",flashvars:"scale="+e.scale+"&callback="+g(function e(){return y(e),--l>0&&c(),!0})},e)),r(!1,o),o=null}function _(e){return{id:e.id,name:e.name,matrix:e.matrix,flashId:e.flashId}}function x(t){var n=t.getBoundingClientRect(),r=i.body,a=(t&&t.ownerDocument).documentElement;return{top:n.top+(e.pageYOffset||a.scrollTop)-(a.clientTop||r.clientTop||0),left:n.left+(e.pageXOffset||a.scrollLeft)-(a.clientLeft||r.clientLeft||0),width:n.right-n.left,height:n.bottom-n.top}}n.Camera.fallback=function(){o.push(arguments)},n.Flash=f,n.newImage("data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",function(e,t){n.support.dataURI=!(1!=t.width||1!=t.height),f.init()})}()}(window,window.jQuery,FileAPI),function(e){e(FileAPI)}(function(e){if(window.navigator&&window.navigator.platform&&/iP(hone|od|ad)/.test(window.navigator.platform)){var t=e.renderImageToCanvas;e.detectSubsampling=function(e){var t,n;return e.width*e.height>1048576&&(t=document.createElement("canvas"),t.width=t.height=1,n=t.getContext("2d"),n.drawImage(e,1-e.width,0),0===n.getImageData(0,0,1,1).data[3])},e.detectVerticalSquash=function(e,t){var n,i,r,a,s,o=e.naturalHeight||e.height,l=document.createElement("canvas"),c=l.getContext("2d");t&&(o/=2),l.width=1,l.height=o,c.drawImage(e,0,0),n=c.getImageData(0,0,1,o).data,i=0,r=o,a=o;while(a>i)s=n[4*(a-1)+3],0===s?r=a:i=a,a=r+i>>1;return a/o||1},e.renderImageToCanvas=function(n,i,r,a,s,o,l,c,u,d){if("image/jpeg"===i._type){var f,p,h,m,v=n.getContext("2d"),g=document.createElement("canvas"),y=1024,b=g.getContext("2d");if(g.width=y,g.height=y,v.save(),f=e.detectSubsampling(i),f&&(r/=2,a/=2,s/=2,o/=2),p=e.detectVerticalSquash(i,f),f||1!==p){a*=p,u=Math.ceil(y*u/s),d=Math.ceil(y*d/o/p),c=0,m=0;while(m<o){l=0,h=0;while(h<s)b.clearRect(0,0,y,y),b.drawImage(i,r,a,s,o,-h,-m,s,o),v.drawImage(g,0,0,y,y,l,c,u,d),h+=y,l+=u;m+=y,c+=d}return v.restore(),n}}return t(n,i,r,a,s,o,l,c,u,d)}}}),function(e){var t=e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype,n=e.Blob&&function(){try{return Boolean(new Blob)}catch(e){return!1}}(),i=n&&e.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(e){return!1}}(),r=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||e.MSBlobBuilder,a=(n||r)&&e.atob&&e.ArrayBuffer&&e.Uint8Array&&function(e){var t,a,s,o,l,c;for(t=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):decodeURIComponent(e.split(",")[1]),a=new ArrayBuffer(t.length),s=new Uint8Array(a),o=0;o<t.length;o+=1)s[o]=t.charCodeAt(o);return l=e.split(",")[0].split(":")[1].split(";")[0],n?new Blob([i?s:a],{type:l}):(c=new r,c.append(a),c.getBlob(l))};e.HTMLCanvasElement&&!t.toBlob&&(t.mozGetAsFile?t.toBlob=function(e,n,i){i&&t.toDataURL&&a?e(a(this.toDataURL(n,i))):e(this.mozGetAsFile("blob",n))}:t.toDataURL&&a&&(t.toBlob=function(e,t,n){e(a(this.toDataURL(t,n)))})),e.dataURLtoBlob=a}(window);var file=FileAPI;function createXHR(){if(window.ActiveXObject)var e=new ActiveXObject("Microsoft.XMLHTTP");else if(window.XMLHttpRequest)e=new XMLHttpRequest;return e}var ajax={get:function(e,t){var n=createXHR();return n.open("GET",e),n.onreadystatechange=function(){4===n.readyState&&(200==n.status?t(null,n.responseText):304!=n.status&&t(!0))},n.send(null),n},post:function(e,t,n){var i=createXHR(),r="?";for(var a in t)t.hasOwnProperty(a)&&(r+=a+"="+t[a]);return i.open("POST",e),i.onreadystatechange=function(){4==i.readyState&&200==i.status?n(null,i.responseText):n(!0)},i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.send(r),i},postBlob:function(e,t,n,i){var r=createXHR();return utils.isFunction(n)&&(i=n,n={}),r.open("POST",e),r.onreadystatechange=function(){4==r.readyState&&200==r.status?i(null.xhr.responseText):i(!0)},n.headers&&utils.each(n.headers,function(e,t){r.setRequestHeader(t,e)}),r.send(t),r}},Asset$3=_Asset({}),imageViewTranslations$1={weight:"w",height:"h",quality:"q"},_Image=function(e){function t(e,n,i){babelHelpers.classCallCheck(this,t);var r=babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this)),a=utils.objExtend(utils.objClone(n.config),{separate:"-"},i);return r.key=e,r.parent=n,r.config=a,r}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"imageInfo",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?noop$3:arguments[0];return new Promise(function(n,i){var r=e.url()+"?imageInfo";ajax.get(r,function(e,r){if(e)return i(e),t(e);var a=JSON.parse(r);n(a),t(null,a)})})}},{key:"exif",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?noop$3:arguments[0];return new Promise(function(n,i){var r=e.url()+"?exif";ajax.get(r,function(e,r){if(e)return i(e),t(e);var a=JSON.parse(r);n(a),t(null,a)})})}},{key:"imageView",value:function(e){var t=this,n=arguments.length<=1||void 0===arguments[1]?noop$3:arguments[1],i=new Promise(function(r,a){var s=e.mode;delete e.mode;var o=t.url(),l={};utils.each(e,function(e,t){imageViewTranslations$1.hasOwnProperty(t)&&(t=imageViewTranslations$1[t]),l[t]=e}),o+=utils.format("?imageView/%d%s",s,genOptUrl$1(l));var c=new Image;c.src=o,i.image=c,r(c),n(null,c)});return i}},{key:"imageMogr",value:function(e){var t=this,n=arguments.length<=1||void 0===arguments[1]?noop$3:arguments[1],i=new Promise(function(r,a){var s=t.url(),o={};utils.objExtend(o,e),s+=utils.format("?imageMogr/v2/auto-orient%s",genOptUrl$1(o));var l=new Image;l.src=s,i.image=l,r(l),n(null,l)});return i}},{key:"watermark",value:function(e){var t=this,n=arguments.length<=1||void 0===arguments[1]?noop$3:arguments[1],i=new Promise(function(r){var a=t.url(),s={},o=e.mode;delete e.mode,utils.objExtend(s,e),s.image=utils.safeEncode(s.image),a+=utils.format("?watermark/%d%s",o,genOptUrl$1(s));var l=new Image;l.src=a,i.image=l,r(l),n(null,l)});return i}}]),t}(Asset$3);function genOptUrl$1(e){var t="";return utils.each(e,function(e,n){t+=utils.format("/%s/%s",n,e)}),t}function noop$3(){return!1}_Image.extend=function(e){return e.imageView=function(e,t){var n=this;return t=t||noop$3,new Promise(function(i){var r=file.Image(n);r._load(n,function(n,a){if(n)return t(n),promise.reject(n);var s={};switch(e.mode=e.mode||1,e.mode){case 1:utils.objExtend(s,{dw:e.width||e.height,dh:e.height||e.width,resize:"preview"});break;case 2:var o=a.width/a.height,l=e.hasOwnProperty("width"),c=e.hasOwnProperty("height");switch(!0){case l&&c:utils.objExtend(s,{dw:e.width,dh:e.height,resize:"max"});break;case l&&!c:utils.objExtend(s,{dw:e.width,dh:e.width/o,resize:"max"});break;case!l&&c:utils.objExtend(s,{dw:e.height*o,dh:e.height,resize:"max"});break}}r.set(s).get(function(e,n){if(e)return t(e),reject(e);t(null,n),i(n)})})})},e.imageMogr=function(e,t){var n=this;return t=t||noop$3,new Promise(function(i,r){var a=file.Image(n);a._load(n,function(n,s){if(n)return t(null),promise.reject(n);var o={},l=s.width/s.height,c=e.thumbnail;switch(c.mode){case 1:utils.objExtend(o,{dw:c.width||c.height,dh:c.height||c.width,resize:"preview",sx:(s.width-c.width)/2,sy:(s.height-c.height)/2,sw:c.width||c.height,sh:c.height||c.width});break;case 2:var u=c.hasOwnProperty("width"),d=c.hasOwnProperty("height");switch(!0){case u&&d:utils.objExtend(o,{dw:c.width,dh:c.height,resize:"max"});break;case u&&!d:utils.objExtend(o,{dw:c.width,dh:c.width/l,resize:"max"});break;case!u&&d:utils.objExtend(o,{dw:c.height*l,dh:c.height,resize:"max"});break}}var f=e.crop,p=f.hasOwnProperty("width"),h=f.hasOwnProperty("height");switch(f.x=f.x||0,f.y=f.y||0,f.gravity,!0){case p&&!h:f.height=f.width/l;break;case!p&&h:f.width=f.height*l;break}f.rotate=f.rotate||0,utils.objExtend(o,{sx:f.x,sy:f.y,sw:f.width,sh:f.height,deg:f.rotate}),a.set(o).get(function(e,n){if(e)return t(e),r(e);t(null,n),i(n)})})})},e.imageInfo=function(e){var t=this;return e=e||noop$3,new Promise(function(n,i){var r=file.Image(t);r._load(t,function(t,r){if(t)return e(t),i(t);var a={width:r.width,height:r.height};e(null,a),n(a)})})},e.getImage=function(){return file.Image(this)},e};var Asset$2=null,globalConfig=null;function noop$2(){return!1}var Bucket$1=function(){function Bucket(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(babelHelpers.classCallCheck(this,Bucket),this.name=e,this.queue=[],this.config=utils.objExtend(globalConfig,t,{scope:e}),!this.config.url)throw new ReferenceError("You should set the url of the bucket.");/\/$/.test(this.config.url)&&(this.config.url=this.config.url.substr(0,this.config.url.length-1))}return babelHelpers.createClass(Bucket,[{key:"putFile",value:function(e,t,n,i){var r=arguments,a=this;return new Promise(function(s,o){switch(r.length){case 3:utils.isFunction(n)?(i=n,n={}):i=noop$2;break;case 2:n={},i=noop$2;break}var l=utils.objExtend(utils.objClone(a.config),n),c=l.putToken,u="http://"+globalConfig.uploadUrl,d=!!window.ActiveXObject,f={token:c,key:e};d&&(f.accept="text/plain; charset=utf-8");var p=file.upload({url:u,data:f,files:{file:t},upload:function(i,r){(n.before&&utils.isFunction(n.before)?n.before:noop$2).call(null,i,e,t)},progress:function(e){var t=e.loaded/e.total*100;(n.progress&&utils.isFunction(n.progress)?n.progress:noop$2).call(null,t,e.loaded,e.total)},complete:function(t,n){if(t)return i(t),o(t);var r=null;r=window.JSON?JSON.parse(p.responseText):p.responseText;var l=a.key(e);i(null,r,l,p,n),s(r,l,p,n)}})})}},{key:"putChunkedFile",value:function putChunkedFile(key,_file,options,callback){var _this2=this;return new Promise(function(resolve,reject){var config=utils.objExtend(utils.objClone(_this2.config),options),putToken=_this2.config.putToken;options.blockSize=options.blockSize||file.MB.form(5);var uploadUrl="http://"+globalConfig.uploadUrl+"/mkblk/"+options.blockSize,blockCtxes=[];if(utils.isFunction(_file.slice))(function loop(url,start,_callback,host){var end=start+options.blockSize;if(!(start<_file.size))return _callback(host);var blob=_file.slice(start,end);ajax.postBlob(url,blob,{headers:{"Content-Type":"application/octet-stream",Authorization:utils.format("UpToken %s",putToken)}},function(err,reply){if(err)return callback(err),reject(err);var replyData=eval(reply);blockCtxes.push(replyData.ctx);var host=replyData.host;loop(utils.format("%s/bput/%s/%s",host,replyData.ctx,end),end,_callback,host)})})(uploadUrl,0,function(e){var t=self.key(key);utils.format("%s/rs-mkfile/%s/fsize/%s/mimeType/%s",e,t.entryUrl(),_file.size,_file.type);options.params&&utils.format("/params/%s"),options.meta&&utils.format("/meta/%s",utils.safeEncode(options.meta)),options.customer&&utils.format("/customer/%s",options.customer),options.rotate&&utils.format("/rotate/%s",options.rotate),ajax.post()});else{var err="no support chunk";reject(err),callback(err)}})}},{key:"getFile",value:function(e){var t=this,n=arguments.length<=1||void 0===arguments[1]?noop$2:arguments[1];return new Promise(function(i,r){var a=t.config.getToken||"",s=null;s=t.config.url?utils.format("%s/%s?e=3600&token=%s",t.url(),e,a):utils.format("http://%s.qiniudn.com/%s?e=3600&token=%s",t.name,e,a),ajax.get(s,function(e,t){if(e)return n(e),r(e);n(null,t),i(t)})})}},{key:"url",value:function(){return this.config.url}},{key:"key",value:function(e){return new Asset$2(e,this)}},{key:"image",value:function(e){return new _Image(e,this)}}]),Bucket}();function _Bucket(e){return globalConfig=e,Asset$2=_Asset(e),Bucket$1}function EventEmitter(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function isFunction(e){return"function"===typeof e}function isNumber(e){return"number"===typeof e}function isObject(e){return"object"===("undefined"===typeof e?"undefined":babelHelpers.typeof(e))&&null!==e}function isUndefined(e){return void 0===e}Bucket$1.Image=_Image,EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._maxListeners=void 0,EventEmitter.defaultMaxListeners=10,EventEmitter.prototype.setMaxListeners=function(e){if(!isNumber(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},EventEmitter.prototype.emit=function(e){var t,n,i,r,a,s;if(this._events||(this._events={}),"error"===e&&(!this._events.error||isObject(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[e],isUndefined(n))return!1;if(isFunction(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:r=Array.prototype.slice.call(arguments,1),n.apply(this,r)}else if(isObject(n))for(r=Array.prototype.slice.call(arguments,1),s=n.slice(),i=s.length,a=0;a<i;a++)s[a].apply(this,r);return!0},EventEmitter.prototype.addListener=function(e,t){var n;if(!isFunction(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,isFunction(t.listener)?t.listener:t),this._events[e]?isObject(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,isObject(this._events[e])&&!this._events[e].warned&&(n=isUndefined(this._maxListeners)?EventEmitter.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"===typeof console.trace&&console.trace())),this},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.once=function(e,t){if(!isFunction(t))throw TypeError("listener must be a function");var n=!1;function i(){this.removeListener(e,i),n||(n=!0,t.apply(this,arguments))}return i.listener=t,this.on(e,i),this},EventEmitter.prototype.removeListener=function(e,t){var n,i,r,a;if(!isFunction(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],r=n.length,i=-1,n===t||isFunction(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(isObject(n)){for(a=r;a-- >0;)if(n[a]===t||n[a].listener&&n[a].listener===t){i=a;break}if(i<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},EventEmitter.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],isFunction(n))this.removeListener(e,n);else if(n)while(n.length)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},EventEmitter.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?isFunction(this._events[e])?[this._events[e]]:this._events[e].slice():[],t},EventEmitter.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(isFunction(t))return 1;if(t)return t.length}return 0},EventEmitter.listenerCount=function(e,t){return e.listenerCount(t)};var _configData={uploadUrl:"up.qiniu.com",rsUrl:"rs.qbox.me",rsfUrl:"rsf.qbox.me"},Asset=_Asset(_configData),Bucket=_Bucket(_configData),qiniu={};function noop(){return!1}function createEventHandler(){var e=new EventEmitter;return e.bind=function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=1===n.length?[{},e]:[e];return n.push.apply(n,r),qiniu.bind.apply(qiniu,n)},e.bind.dnd=function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=1===n.length?[{},e]:[e];return n.push.apply(n,r),qiniu.bind.dnd.apply(qiniu,n)},e}return qiniu.config=function(e,t){if(arguments.length>1&&e instanceof String)qiniu.set(e,t);else switch(!0){case utils.isString(e):return qiniu.get(e);case utils.isObject(e):for(var n in e)(function(t){qiniu.set(t,e[t])})(n);break}return this},qiniu.set=function(e,t){return _configData[e]=t,this},qiniu.get=function(e){return _configData[e]},qiniu.bind=function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=arguments[2],i=createEventHandler();if(n){var r=["file","over","out","dnd.success","dnd.error"];r.forEach(function(e){return n.on(e,function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return i.emit.apply(i,[e].concat(n))})})}var a=".qiniu-transparent {     z-index: 1000;     zoom: 1;     opacity: 0;     -moz-opacity: 0;     -khtml-opacity: 0;     filter: 'alpha(opacity=0)';     *filter: alpha(opacity=0);   }",s=document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css",o.styleSheet?o.styleSheet.cssText=a:o.appendChild(document.createTextNode(a)),s.appendChild(o);var l=document.createElement("div"),c='<div class="js-fileapi-wrapper qiniu-transparent"></div>';l.innerHTML=c;var u=l.firstChild;if(e.jquery)e.before(u).addClass("select-btn");else{var d=e.parentNode;d.insertBefore(u,e)}var f=document.createElement("input");return f.type="file",f.className="qiniu-transparent",f.multiple=!0,u.appendChild(f),e=e.jquery?e.get(0):e,utils.css(u,{top:e.style.top,right:e.style.right,position:"absolute",width:e.offsetWidth+5,height:e.offsetHeight+5,margin:e.style.margin}),utils.css(f,{width:e.offsetWidth+5,height:e.offsetHeight+5,position:"relative"}),file.event.on(f,"change",function(e){var n=file.getFiles(e),r=t.filter||!1,a={image:/image/,audio:/audio/,video:/video/,media:/audio|video/};switch(!0){case utils.isString(r):a[r]&&(n=file.filter(n,function(e){return a[r].test(e.type)}));break;case utils.isArray(r):for(var s=0;s<r.length;s++)(function(e){n=file.filter(n,function(t){return a[r[e]].test(t.type)})})(s);break;case r instanceof RegExp:n=file.filter(n,function(e){return r.test(e.type)});break}for(var o=0;o<n.length;o++)(function(e){i.emit("file",_Image.extend(n[e]))})(o)}),i},qiniu.bind.dnd=function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=arguments[2],i=createEventHandler();if(n){var r=["file","over","out","dnd.success","dnd.error"];r.forEach(function(e){return n.on(e,function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return i.emit.apply(i,[e].concat(n))})})}return file.support.dnd?(file.event.dnd(e.jquery?e.get(0):e,function(e){var n=t.filter||!1,r={image:/image/,audio:/audio/,video:/video/,media:/audio|video/};switch(!0){case utils.isString(n):r[n]&&(e=file.filter(e,function(e){return r[n].test(e.type)}));break;case utils.isArray(n):for(var a=0;a<n.length;a++)(function(t){e=file.filter(e,function(e){return r[n[t]].test(e.type)})})(a);break;case n instanceof RegExp:e=file.filter(e,function(e){return n.test(e.type)});break}for(var s=0;s<e.length;s++)(function(t){i.emit("file",_Image.extend(e[t]))})(s)}),file.event.on(e.jquery?e.get(0):e,"dragover dragleave",function(e){switch(e.type){case"dragover":(t.over&&utils.isFunction(t.over)?t.over:noop).call(null),i.emit("over");break;case"dragleave":(t.out&&utils.isFunction(t.out)?t.out:noop).call(null),i.emit("out")}}),(t.success&&utils.isFunction(t.success)?t.success:noop).call(null),i.emit("dnd.success")):(i.emit("dnd.error","no support"),(t.error&&utils.isFunction(t.error)?t.error:noop).call(null,"no support")),i},qiniu.supportDnd=file.support.dnd,qiniu.bucket=function(e,t){return new Bucket(e,t)},qiniu.Asset=Asset,qiniu.Bucket=Bucket,qiniu.Image=_Image,utils.objExtend(qiniu,EventEmitter.prototype),EventEmitter.call(qiniu),qiniu})},ac6a:function(e,t,n){for(var i=n("cadf"),r=n("0d58"),a=n("2aba"),s=n("7726"),o=n("32e9"),l=n("84f2"),c=n("2b4c"),u=c("iterator"),d=c("toStringTag"),f=l.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},h=r(p),m=0;m<h.length;m++){var v,g=h[m],y=p[g],b=s[g],w=b&&b.prototype;if(w&&(w[u]||o(w,u,f),w[d]||o(w,d,g),l[g]=f,y))for(v in i)w[v]||a(w,v,i[v],!0)}},d83e:function(e,t,n){},dfce:function(e,t,n){"use strict";var i=n("331c"),r=n.n(i);r.a}}]);
//# sourceMappingURL=chunk-11e1480a.0aafde8e.js.map